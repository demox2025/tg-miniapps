<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Demo Mini App</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<!-- Monetag Ad Script (‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶Ø‡ßá‡¶ü‡¶æ ‡¶¶‡¶ø‡ßü‡ßá‡¶õ) -->
<script src='//libtl.com/sdk.js' data-zone='9715146' data-sdk='show_9715146'></script>

<style>
body { font-family: system-ui, Arial, sans-serif; background:#0f172a; color:#fff; margin:0; padding:16px; }
.card { background:#111827; padding:16px; border-radius:12px; margin-bottom:12px; }
.btn { background:#06b6d4; color:#001; padding:12px 16px; border:none; border-radius:8px; font-weight:700; }
</style>
</head>
<body>
<div class="card">
  <h2>üëã ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ Demo Mini App-‡¶è</h2>
  <p id="hello">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
</div>
<div class="card">
  <button id="claimBtn" class="btn">‚úÖ Claim Reward</button>
  <p id="msg"></p>
</div>

<script>
const tg = window.Telegram?.WebApp; tg && tg.expand();
const user = tg?.initDataUnsafe?.user;
document.getElementById('hello').innerText = user ?
    `‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã, ${user.first_name} (ID: ${user.id})` :
    'Telegram ‡¶è‡¶∞ ‡¶≠‡¶ø‡¶§‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶ñ‡ßÅ‡¶≤‡ßÅ‡¶®';

// Backend ‡¶è‡¶ï‡¶á ‡¶°‡ßã‡¶Æ‡ßá‡¶á‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠ ‡¶π‡¶¨‡ßá (Render) ‚Äî ‡¶§‡¶æ‡¶á ‡¶∞‡¶ø‡¶≤‡ßá‡¶ü‡¶ø‡¶≠ ‡¶™‡¶æ‡¶• ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø
document.getElementById("claimBtn").onclick = async () => {
  let res = await fetch("/claim", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({user_id: user?.id})
  });
  let data = await res.json();
  document.getElementById("msg").innerText = data.message || "Done";
};
</script>
</body>
</html>
